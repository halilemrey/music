<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Halil Emre - Music Profile</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: 'Poppins', sans-serif;
    background-color: #121212;
  }
  #particle-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
  }
  .card-wrapper {
    position: absolute;
    will-change: transform;
    transition: opacity 1.5s ease;
  }
  .card-wrapper iframe {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
  }
  .spotify-icon {
    transition: transform 0.3s, filter 0.3s;
    cursor: pointer;
  }
  .spotify-icon:hover {
    transform: scale(1.1);
    filter: brightness(1.3);
  }
  .content-safe-zone {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 400px;
    max-width: 90%;
    transform: translate(-50%, -50%);
    z-index: 5;
    text-align: center;
    padding: 2.5rem;
    background: rgba(25, 20, 20, 0.75); /* ArtÄ±rÄ±lmÄ±ÅŸ opaklÄ±k, blursuz */
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
    /* backdrop-filter ve -webkit-backdrop-filter kaldÄ±rÄ±ldÄ± */
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.18);
    animation: fadeInUp 1s ease-out;
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translate(-50%, calc(-50% + 20px)); }
    to { opacity: 1; transform: translate(-50%, -50%); }
  }
  .content-safe-zone * {
    pointer-events: auto;
  }
  .footer-disclaimer {
    position: absolute;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.4);
    text-align: center;
    width: 90%;
    z-index: 10;
  }
  @media (max-width: 768px) {
    .content-safe-zone { width: 90%; padding: 1.5rem; }
    .content-safe-zone h1 { font-size: 2.5rem; }
    .content-safe-zone p { font-size: 1rem; }
    .content-safe-zone .spotify-icon { width: 5rem; }
    .footer-disclaimer { font-size: 0.6rem; }
  }
</style>
</head>
<body class="text-white">

  <canvas id="particle-canvas"></canvas>
  
  <div class="footer-disclaimer">
    Bu site kiÅŸisel ve ticari olmayan bir projedir. TÃ¼m albÃ¼m kapaklarÄ± ve marka logolarÄ±, ilgili sahiplerinin mÃ¼lkiyetindedir.
  </div>

  <div class="content-safe-zone">
    <h1 class="text-5xl font-bold mb-4">Halil Emre</h1>
    <p class="text-lg mb-6 text-gray-300">
      Welcome to my music space. Cards will find you here ðŸŽ¶
    </p>
    <div class="flex gap-6 justify-center">
      <a href="https://open.spotify.com/user/slhwdejaps98mgy3ldr2fpqks?si=03f3dba54b9a48aa" target="_blank">
        <img src="https://cdn-icons-png.flaticon.com/512/174/174872.png" alt="Spotify" class="w-28 spotify-icon"/>
      </a>
    </div>
  </div>

  <div id="card-container" class="absolute top-0 left-0 w-full h-full z-0"></div>

<script>
    // --- KARTLAR Ä°Ã‡Ä°N DÄ°NAMÄ°K AYARLAR ---
    let cardWidth, cardHeight, maxConcurrentCards, particleCount;

    function setDynamicVariables() {
        if (window.innerWidth <= 768) {
            cardWidth = 200; 
            cardHeight = 80; // Mobil iÃ§in uygun yÃ¼kseklik
            maxConcurrentCards = 3; 
            particleCount = 40; // Mobil iÃ§in azaltÄ±lmÄ±ÅŸ partikÃ¼l sayÄ±sÄ±
        } else {
            cardWidth = 300; 
            cardHeight = 152; // MasaÃ¼stÃ¼ iÃ§in standart kompakt yÃ¼kseklik
            maxConcurrentCards = 4; 
            particleCount = 100;
        }
    }
    setDynamicVariables();
    
    const CARD_LIFETIME = 5000;
    const FADE_OUT_DURATION = 1500;

    const allCards = [
        { embedSrc: "https://open.spotify.com/embed/track/07q0QVgO56EorrSGHC48y3?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/6si71supnBUhddjR2FJc2L?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/album/0mHYRe0jUP2pWxrL7oP5qO?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/3tCcO0uqXnoB8NnFuMPoIS?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/68xnudIZzP49DreYAMlbqZ?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/1wMvP4KuZOcA3kum0TE6x6?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/4lwfABJjnJYPIgLjuGiB63?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/3hRV0jL3vUpRrcy398teAU?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/6EMErc5L7mnqJ5JsWFYRgX?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/52v12pqh8SBzZ6OSi8ciUL?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/6uS2G7PdDL0qmYs6glOgrO?utm_source=generator" },
        { embedSrc: "https://open.spotify.com/embed/track/31AOj9sFz2gM0O3hMARRBx?utm_source=generator" }
    ];

    const cardContainer = document.getElementById('card-container');
    const safeZoneEl = document.querySelector('.content-safe-zone');
    let safeZoneRect;

    function updateSafeZone() { safeZoneRect = safeZoneEl.getBoundingClientRect(); }
    updateSafeZone();

    // --- YENÄ°DEN BOYUTLANDIRMA YÃ–NETÄ°CÄ°SÄ° ---
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    function handleResize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        setDynamicVariables();
        updateSafeZone();
        initParticles();
    }
    window.addEventListener('resize', debounce(handleResize, 250));
    
    const floatingCards = [];
    const activeCards = {}; 

    function rectsOverlap(rect1, rect2) { return !(rect1.right < rect2.left || rect1.left > rect2.right || rect1.bottom < rect2.top || rect1.top > rect2.bottom); }
    
    function getSafeRandomPosition() {
        let x, y, isSafe, attempts = 0;
        do {
            x = Math.random() * (window.innerWidth - cardWidth);
            y = Math.random() * (window.innerHeight - cardHeight);
            const newCardRect = { left: x, top: y, right: x + cardWidth, bottom: y + cardHeight };
            isSafe = true;
            if (rectsOverlap(newCardRect, safeZoneRect)) { isSafe = false; }
            if (isSafe) {
                for (const existingCard of floatingCards) {
                    if (rectsOverlap(newCardRect, { left: existingCard.x, top: existingCard.y, right: existingCard.x + cardWidth, bottom: existingCard.y + cardHeight })) {
                        isSafe = false; break;
                    }
                }
            }
            attempts++;
        } while (!isSafe && attempts < 100);
        return { x, y };
    }

    function createFloatingCard(cardData) {
        if (!cardData) return;
        const { x, y } = getSafeRandomPosition();
        
        const cardId = 'card-' + Date.now() + Math.random();
        const wrapper = document.createElement('div');
        wrapper.className = 'card-wrapper';
        wrapper.id = cardId;
        wrapper.style.opacity = '0';
        wrapper.style.transform = `translate3d(${x}px, ${y}px, 0)`;

        const iframe = document.createElement('iframe');
        iframe.style.borderRadius = '12px';
        iframe.src = cardData.embedSrc;
        iframe.width = `${cardWidth}px`;
        iframe.height = `${cardHeight}px`;
        iframe.frameBorder = '0';
        iframe.allow = "autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture";
        iframe.loading = "lazy";
        
        wrapper.appendChild(iframe);
        cardContainer.appendChild(wrapper);
        
        const cardInfo = {
            cardData: cardData,
            element: wrapper,
            x, y,
            directionX: (Math.random() - 0.5) * 0.4,
            directionY: (Math.random() - 0.5) * 0.4,
            isPaused: false
        };
        floatingCards.push(cardInfo);
        activeCards[cardId] = cardInfo;

        setTimeout(() => { wrapper.style.opacity = '1'; }, 100);
        
        setTimeout(() => {
            wrapper.style.opacity = '0';
            setTimeout(() => {
                const index = floatingCards.findIndex(fc => fc.element.id === cardId);
                if (index > -1) floatingCards.splice(index, 1);
                delete activeCards[cardId];
                if (cardContainer.contains(wrapper)) cardContainer.removeChild(wrapper);
            }, FADE_OUT_DURATION);
        }, CARD_LIFETIME);
    }

    window.addEventListener('message', event => {
        try {
            const data = JSON.parse(event.data);
            if (data.command === 'play' || data.command === 'pause') {
                let sourceIframe = null;
                document.querySelectorAll('iframe').forEach(iframe => {
                    if (iframe.contentWindow === event.source) {
                        sourceIframe = iframe;
                    }
                });
                if (sourceIframe) {
                    const wrapperId = sourceIframe.parentElement.id;
                    const card = activeCards[wrapperId];
                    if (card) {
                        card.isPaused = (data.command === 'play');
                    }
                }
            }
        } catch (e) { /* Ignore non-JSON messages */ }
    });

    let shuffledPlaylist = [];
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    function getNextCard() {
        if (shuffledPlaylist.length === 0) {
            shuffledPlaylist = shuffleArray([...allCards]);
        }
        return shuffledPlaylist.pop();
    }
    setInterval(() => {
        if (floatingCards.length < maxConcurrentCards) {
            const onScreenSrcs = floatingCards.map(info => info.cardData.embedSrc);
            let nextCard = getNextCard();
            let attempts = 0;
            while (onScreenSrcs.includes(nextCard.embedSrc) && attempts < allCards.length) {
                shuffledPlaylist.unshift(nextCard);
                nextCard = getNextCard();
                attempts++;
            }
            if (!onScreenSrcs.includes(nextCard.embedSrc)) {
                createFloatingCard(nextCard);
            }
        }
    }, 1500);
    
    // --- PARTÄ°KÃœL KODU (Optimize EdilmiÅŸ) ---
    const canvas = document.getElementById('particle-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    let particlesArray;
    const particleConfig = {
        particleColor: '#1DB954', lineColor: '#2b5a3d', connectionDistance: 120, particleSpeed: 0.5, particleSize: 2
    };
    class Particle {
        constructor(x, y, dX, dY, s, c) { this.x = x; this.y = y; this.directionX = dX; this.directionY = dY; this.size = s; this.color = c; }
        draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); ctx.fillStyle = this.color; ctx.fill(); }
        update() {
            if (this.x > canvas.width || this.x < 0) this.directionX *= -1;
            if (this.y > canvas.height || this.y < 0) this.directionY *= -1;
            this.x += this.directionX; this.y += this.directionY;
        }
    }
    function initParticles() {
        particlesArray = [];
        // particleCount deÄŸiÅŸkeni artÄ±k dinamik olarak ayarlanÄ±yor
        for (let i = 0; i < particleCount; i++) {
            let s = (Math.random() * particleConfig.particleSize) + 1;
            let x = (Math.random() * (innerWidth - s*2)) + s*2;
            let y = (Math.random() * (innerHeight - s*2)) + s*2;
            let dX = (Math.random() * particleConfig.particleSpeed) - (particleConfig.particleSpeed/2);
            let dY = (Math.random() * particleConfig.particleSpeed) - (particleConfig.particleSpeed/2);
            particlesArray.push(new Particle(x, y, dX, dY, s, particleConfig.particleColor));
        }
    }
    
    function masterAnimate() {
        ctx.clearRect(0, 0, innerWidth, innerHeight);
        particlesArray.forEach(p => { p.update(); p.draw(); });
        
        // PERFORMANS KATÄ°LÄ° OLAN Ã‡Ä°ZGÄ° Ã‡Ä°ZME KODU KALDIRILDI

        floatingCards.forEach((card, index) => {
            if (!card.isPaused) {
                card.x += card.directionX; card.y += card.directionY;
                if (card.x <= 0 || card.x >= window.innerWidth - cardWidth) card.directionX *= -1;
                if (card.y <= 0 || card.y >= window.innerHeight - cardHeight) card.directionY *= -1;
            }

            const cardRect = { left: card.x, top: card.y, right: card.x + cardWidth, bottom: card.y + cardHeight };
            
            // GÃ¼venli bÃ¶lgeyle Ã§arpÄ±ÅŸma (daha yumuÅŸak)
            if (rectsOverlap(cardRect, safeZoneRect)) { 
                card.directionX *= -1; 
                card.directionY *= -1;
                card.x += card.directionX * 2; 
                card.y += card.directionY * 2;
            }

            for (let i = index + 1; i < floatingCards.length; i++) {
                if (rectsOverlap(cardRect, { left: floatingCards[i].x, top: floatingCards[i].y, right: floatingCards[i].x + cardWidth, bottom: floatingCards[i].y + cardHeight })) {
                    if (!card.isPaused) {
                        const tempX = card.directionX; const tempY = card.directionY;
                        card.directionX = floatingCards[i].directionX; card.directionY = floatingCards[i].directionY;
                        floatingCards[i].directionX = tempX; floatingCards[i].directionY = tempY;
                    }
                }
            }
            card.element.style.transform = `translate3d(${card.x}px, ${card.y}px, 0)`;
        });
        
        requestAnimationFrame(masterAnimate);
    }
    
    initParticles();
    masterAnimate();
</script>

</body>
</html>
